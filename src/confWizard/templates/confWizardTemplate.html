## -*- coding: utf-8 -*-

<div id="output_container" style="height:30px;" >
    <div id="output" style="text-align:center;">
    </div>
</div>

<div style="margin: 0 auto;width: 400px;">
% if localclient:
   <button id="camera_calib_button" style="width:400px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text"> ${language['camera_calib_but'].decode('utf-8')} </span></button> </br>
   </br>
   <button id="hand_gesture_calib_button" style="width:400px;"  class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text"> ${language['hand_gesture_calib_but'].decode('utf-8')} </span></button>
% else:

   <button id="camera_calib_button" style="width:400px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only qbo_button_improved" disabled="disabled">  

        <a style="color:gray !important;" target="_blank" class="tooltip" title="${language['config_wizard_alert'].decode('utf-8')}" >  <span class="ui-button-text"> ${language['camera_calib_but']} </span>  </a>  
    </button> </br>
   </br>
   <button id="hand_gesture_calib_button" style="width:400px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only qbo_button_improved" disabled="disabled"> 

     <a style="color:gray !important;" target="_blank" class="tooltip" title="${language['config_wizard_alert'].decode('utf-8')}" > <span class="ui-button-text"> ${language['hand_gesture_calib_but']} </span>  </a>

   </button>
   </br>
   </br>


% endif
</br>


   <button id="btn_create_user" style="width:400px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text"> ${language['config_btn_create_user'].decode('utf-8')} </span></button>

</br>

<fieldset id="fieldset_create_user" style="width: 365px;border: 2px solid #4297D7; display:none;" >
    <legend>${language['config_title_create_user'].decode('utf-8')}</legend>
    <table>
        <tr>
            <td>
                ${language['config_user_name'].decode('utf-8')}
            </td>
            <td>
                 <input id="newUserName" type="text" />
            </td>
        </tr>
        <tr>
            <td>
                ${language['config_password'].decode('utf-8')}
            </td>
            <td>
                <input id="newUserPassword" type="password" />
            </td>
        </tr>
        <tr>
            <td>
                ${language['config_repeat_password'].decode('utf-8')}
            </td>
            <td>
                <input id="newUserPassword2" type="password" />
            </td>
        </tr>
    </table>

    <div id="errorMesages4Passwords" style="display:none;" ></div>

    <div id="saveButton" style="text-align: center;" >

<button id="save_create_user" style="width:200px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only qbo_button_improved" > <a target="_blank" class="tooltip" title="${language['config_save_password'].decode('utf-8')}" >  <span>  ${language['config_save_password']} </span> </a>  </button>


    </div>

</fieldset>

</br>


   <button id="btn_change_password" style="width:400px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text"> ${language['config_btn_change_password'].decode('utf-8')} </span></button>

    </br>

<fieldset id="fieldset_change_password" style="width: 365px;border: 2px solid #4297D7; display:none;" >
    <legend>${language['config_title_password'].decode('utf-8')}</legend>
    <table>
        <tr>
            <td>
                ${language['config_user_name'].decode('utf-8')}
            </td>
            <td>
                <!-- <input id="userName" type="text" /> -->
                <select class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" id="userName" name="userName"> </select>
            </td>
        </tr>
        <tr>
            <td>
                ${language['config_old_password'].decode('utf-8')}
            </td>
            <td>
                <input id="oldPassword" type="password" />
            </td>
        </tr>
        <tr>
            <td>
                ${language['config_password'].decode('utf-8')}
            </td>
            <td>
                <input id="password" type="password" />
            </td>
        </tr>
        <tr>
            <td>
                ${language['config_repeat_password'].decode('utf-8')}
            </td>
            <td>
                <input id="password2" type="password" />
            </td>
        </tr>
    </table>

    <div id="errorMesages4Passwords" style="display:none;" ></div>

    <div id="saveButton" style="text-align: center;" >

<button id="save_change_password" style="width:200px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only qbo_button_improved" > <a target="_blank" class="tooltip" title="${language['config_save_password'].decode('utf-8')}" >  <span>  ${language['config_save_password']} </span> </a>  </button>


    </div>

</fieldset>


















</div>


<script>

function startEverything(){
jQuery("#camera_calib_button").click(function(){
   jQuery.post("/confWizard/camera_calib",function(data){
       if (data!="true")
        {       
        jQuery("#output").html('<font color="red"> ${language["camera_calib_err"].decode("utf-8")} </font>');
        }
    });
});
jQuery("#hand_gesture_calib_button").click(function(){
   jQuery.post("/confWizard/hand_gesture_calib",function(data){
       if (data!="true")
       {       
       jQuery("#output").html('<font color="red"> ${language["hand_gesture_calib_err"].decode("utf-8")} </font>');
       } 
   });
});


jQuery("#save_create_user").click(function(data){


    userName = jQuery("#newUserName").val();
    newPwd1 = jQuery("#newUserPassword").val();
    newPwd2 = jQuery("#newUserPassword2").val();

    param = {"userName": userName, "newPassword1": newPwd1 , "newPassword2": newPwd2};



    jQuery.post("/confWizard/create_user",param,function(data){
        if(data==0){
            printMessage('${language["config_everything_ok"].decode("utf-8")}',"info");
            setUsersNamesToSelect();
        }else if(data==-1){
            printMessage('${language["config_user_already_exists"].decode("utf-8")}',"error");
        }else if (data==-2){
            printMessage('${language["config_pwd_not_equals"].decode("utf-8")}',"error");
        }    
    });

});


jQuery("#save_change_password").click(function(data){


    userName = jQuery("#userName").val();
    oldPwd = jQuery("#oldPassword").val();
    newPwd1 = jQuery("#password").val();
    newPwd2 = jQuery("#password2").val();

    param = {"userName": userName, "oldPassword": oldPwd , "newPassword1": newPwd1 , "newPassword2": newPwd2};

    jQuery.post("/confWizard/save_password",param,function(data){
        if(data==0){
            printMessage('${language["config_everything_ok"].decode("utf-8")}',"info");
        }else if(data==-1){
            printMessage('${language["config_wrong_old_pwd"].decode("utf-8")}',"error");
        }else if (data==-2){
            printMessage('${language["config_pwd_not_equals"].decode("utf-8")}',"error");
        }else if (data==-3){
            printMessage('${language["config_user_does_not_exist"].decode("utf-8")}',"info");
        }
        
    });

});


jQuery("#btn_create_user").click(function(data){
    jQuery("#fieldset_create_user").toggle();
    jQuery("#fieldset_change_password").hide();
});

jQuery("#btn_change_password").click(function(data){

    jQuery("#fieldset_change_password").toggle();
    jQuery("#fieldset_create_user").hide();
});



setUsersNamesToSelect();




}


function setUsersNamesToSelect(){
    jQuery.post("/confWizard/get_list_users",function(data){

        jQuery("#userName").html("");
        if(data == ""){
            jQuery("#userName").append("<option>There are no users yet</option>");
        }
        names=data.split(":::");
        for (name in names){
            if (names[name]=="") break;
            jQuery("#userName").append("<option>"+names[name]+"</option>");
        }
    });
}

function printMessage(string,nature){    
    if (nature=="info"){
        jQuery("#output").css('color', 'blue');    
    }else if (nature=="error"){
        jQuery("#output").css('color', 'red'); 
    }

    jQuery("#output").html(string);
    jQuery("#output").fadeIn("slow");
    setTimeout('jQuery("#output").fadeOut("slow",function(){ jQuery("#output").html("");  });',1500);
}


</script>
<script>
   startEverything();
</script>
